/* jquery.zfakeselect.plugin.min | Description: Makes IE select dropdowns usable in a shrinked environment */
(function($){$.fn.zFakeSel=function(override){var defaults={"selectWidth":100,"optionWidth":10,"scrollEnable":300,"browser":document.all,"fontsize":8,"cfakeCombo":{"border":"2px outset #7b9ebd","overflow":"hidden","padding":"0px 3px 0px 0px","border-width":"1px 1px 1px 2px","background":"#FFF","margin":"0px","position":"absolute"},"cfakeSel":{"text-align":"left","color":"#000","background":"#FFF","width":"inherit","padding":"0px 1px","cursor":"default","border":"1px dotted #FFF","border-width":"1px 0px","margin":"0px"},"cfakeSelHover":{"color":"#FFF !important","background":"#3169C6","cursor":"default"},"randClassId":Math.floor(Math.random()*(9999999-1+1)+1)};override.cfakeCombo=$.extend(defaults.cfakeCombo,override.cfakeCombo);override.cfakeSel=$.extend(defaults.cfakeSel,override.cfakeSel);override.cfakeSelHover=$.extend(defaults.cfakeSelHover,override.cfakeSelHover);var p=$.extend(defaults,override);return this.each(function(){if(!p.browser)return true;var sel=$(this).width(p.selectWidth);var wrap=sel.after("<span class=selectWrpSpn></span>").next();wrap.css({margin:getcssCompositeProp(sel,"margin"),padding:getcssCompositeProp(sel,"padding"),left:sel.position().left,top:sel.position().top,width:sel.width()+2,height:sel.height()+2,opacity:0,position:"absolute",background:"#ccc"});$(document).on("mousedown",function(e){if($(e.target).closest("#fakeSel").length===0)$("#fakeSel").remove()});throwOutCSS([["p.cfakeSel",p.cfakeSel],["p.cfakeSelHover",p.cfakeSelHover]],p.randClassId);wrap.click(function(event){var fakeSel=$("#fakeSel").remove();var opts=sel.children(),opt;sel.after('<div id=fakeSel ref="'+sel.attr("id")+'"></div>');var nOpts="";opts.each(function(){opt=$(this);nOpts+='<p class="cfakeSel'+p.randClassId+(opt.is(":selected")?" cfakeSelHover"+p.randClassId:"")+'" dt='+opt.val()+">"+opt.text()+"</p>"});nOpts=$(nOpts);nOpts.hover(function(){$(this).siblings().removeClass("cfakeSelHover"+p.randClassId);$(this).toggleClass("cfakeSelHover"+p.randClassId)});nOpts.click(function(){sel.val($(this).attr("dt")).trigger("change");fakeSel.remove()});fakeSel=$("#fakeSel").append(nOpts);var pos=getPosition(sel.get(0));var maxOptHgt=(fakeSel.find("p").get(0).clientHeight+2)*opts.length;maxOptHgt=maxOptHgt>p.scrollEnable?p.scrollEnable:maxOptHgt;var scrollEnable=maxOptHgt==p.scrollEnable;var maxOptWidth=fakeSel.find("p").max(function(){return $(this).text().length})*p.fontsize;maxOptWidth=maxOptWidth>p.optionWidth?maxOptWidth:p.optionWidth+(scrollEnable?30:0);fakeSel.css(p.cfakeCombo).css({width:maxOptWidth,height:maxOptHgt,left:pos.x,top:pos.y+sel.height(),"overflow-y":scrollEnable?"scroll":"hidden","margin":sel.css("margin")});event.stopPropagation()})})};$.fn.max=function(selector){return Math.max.apply(null,this.map(function(index,el){return selector.apply(el)}).get())};function throwOutCSS(rules,rndId){var cssRl="",tmp,cssObj;for(var i=0;i<rules.length;i++){cssObj=rules[i][1],tmp="";$.each(cssObj,function(key,value){tmp+=key+":"+value+";"});cssRl+=rules[i][0]+rndId+"{"+tmp+"}"}$('<style type="text/css">'+cssRl+"</style>").appendTo("head")}function getcssCompositeProp(el,prp){el=$(el);return el.css(prp+"Top")+" "+el.css(prp+"Right")+" "+el.css(prp+"Bottom")+" "+el.css(prp+"Left")}function getPosition(el){var p={x:el.offsetLeft,y:el.offsetTop};while(el.offsetParent){el=el.offsetParent;p.x+=el.offsetLeft;p.y+=el.offsetTop;if(el!=document.body&&el!=document.documentElement){p.x-=el.scrollLeft;p.y-=el.scrollTop}}p.y=p.y;return p}})(jQuery);
